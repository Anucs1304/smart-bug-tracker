<!DOCTYPE html>
<html>
<head>
  <title>Bug Tracker Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Bug Tracker Dashboard</h1>

  <canvas id="severityChart" width="300" height="150"></canvas>
  <canvas id="rulesChart" width="300" height="150"></canvas>
  <canvas id="confidenceChart" width="600" height="200"></canvas>


  <script>
    async function loadData() {
      const stats = await fetch("/stats").then(r => r.json());
      const rules = await fetch("/rules").then(r => r.json());
      const trend = await fetch("/confidence_trend").then(r => r.json());

      new Chart(document.getElementById("severityChart"), {
        type: 'pie',
        data: {
          labels: Object.keys(stats.severity_counts),
          datasets: [{
            data: Object.values(stats.severity_counts),
            backgroundColor: ['#e74c3c','#f1c40f','#3498db']
          }]
        }
      });

      new Chart(document.getElementById("rulesChart"), {
        type: 'bar',
        data: {
          labels: Object.keys(rules.rule_counts),
          datasets: [{
            label: 'Rule Frequency',
            data: Object.values(rules.rule_counts),
            backgroundColor: '#2ecc71'
          }]
        }
      });

      new Chart(document.getElementById("confidenceChart"), {
    type: 'line',
    data: {
      labels: trend.timestamps,
      datasets: [{
        label: 'Confidence over time',
        data: trend.confidences,
        borderColor: '#9b59b6',
        fill: false,
        tension: 0.1
      }]
    },
      options: {
        scales: {
          x: { title: { display: true, text: 'Timestamp' } },
          y: { title: { display: true, text: 'Confidence' }, min: 0, max: 1 }
        }
      }
    });
  }
  loadData();
  </script>
</body>
</html>
